<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.547">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lineup_optimization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="lineup_optimization_files/libs/clipboard/clipboard.min.js"></script>
<script src="lineup_optimization_files/libs/quarto-html/quarto.js"></script>
<script src="lineup_optimization_files/libs/quarto-html/popper.min.js"></script>
<script src="lineup_optimization_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lineup_optimization_files/libs/quarto-html/anchor.min.js"></script>
<link href="lineup_optimization_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lineup_optimization_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lineup_optimization_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lineup_optimization_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lineup_optimization_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Import Packages &amp; Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="41e7939a" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>uconn_data <span class="op">=</span> pd.read_csv(<span class="st">'data/in-game-trackman/final_fall_stats.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-cleaning-necessary-information" class="level1">
<h1>Data Cleaning &amp; Necessary Information</h1>
<div id="d8edfbfc" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>uconn_data[<span class="st">'Name'</span>] <span class="op">=</span> uconn_data[<span class="st">'First'</span>] <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> uconn_data[<span class="st">'Last'</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>uconn_data.drop(columns <span class="op">=</span> [<span class="st">'First'</span>, <span class="st">'Last'</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>req_data <span class="op">=</span> uconn_data[[<span class="st">'Name'</span>, <span class="st">'Prob1B'</span>, <span class="st">'Prob2B'</span>, <span class="st">'Prob3B'</span>, <span class="st">'Prob4B'</span>, <span class="st">'ProbOut'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="todo-1-set-player-positions" class="level2">
<h2 class="anchored" data-anchor-id="todo-1-set-player-positions">TODO 1: Set Player Positions</h2>
<div id="265f8794" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># players per position</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>catcher <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Mike Oates'</span>, <span class="st">'Gabriel Tirado'</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>first_b <span class="op">=</span> [<span class="st">'Maddix Dalena'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Gabriel Tirado'</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>second_b <span class="op">=</span> [<span class="st">'Ryan Daniels'</span>, <span class="st">'Jack LaRose'</span>, <span class="st">'Bryan Padilla'</span>, <span class="st">'Rob Rispoli'</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>third_b <span class="op">=</span> [<span class="st">'Tyler Minick'</span>, <span class="st">'Bryan Padilla'</span>, <span class="st">'Jack LaRose'</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ss <span class="op">=</span> [<span class="st">'Anthony Belisario'</span>, <span class="st">'Bryan Padilla'</span>, <span class="st">'Rob Rispoli'</span>]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>left <span class="op">=</span> [<span class="st">'Sam Biller'</span>, <span class="st">'Carter Groen'</span>, <span class="st">'Drew Kron'</span>, <span class="st">'Beau Root'</span>, <span class="st">'Aidan Dougherty'</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>right <span class="op">=</span> [<span class="st">'Sam Biller'</span>, <span class="st">'Aidan Dougherty'</span>, <span class="st">'Carter Groen'</span>, <span class="st">'Caleb Shpur'</span>, <span class="st">'Drew Kron'</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>center <span class="op">=</span> [<span class="st">'Sam Biller'</span>, <span class="st">'Drew Kron'</span>, <span class="st">'Beau Root'</span>, <span class="st">'Caleb Shpur'</span>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>dh <span class="op">=</span> [<span class="st">'Maddix Dalena'</span>, <span class="st">'Ryan Daniels'</span>, <span class="st">'Matt Garbowski'</span>, <span class="st">'Carter Groen'</span>, <span class="st">'Tyler Minick'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="todo-2-establish-definite-starters" class="level2">
<h2 class="anchored" data-anchor-id="todo-2-establish-definite-starters">TODO 2: Establish Definite Starters</h2>
<div id="586efb1a" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definite starters</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>starters <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Maddix Dalena'</span>, <span class="st">'Bryan Padilla'</span>, <span class="st">'Ryan Daniels'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Tyler Minick'</span>, <span class="st">'Caleb Shpur'</span>, <span class="st">'Sam Biller'</span>, <span class="st">'Rob Rispoli'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="todo-3-limit-player-positions-in-lineup" class="level2">
<h2 class="anchored" data-anchor-id="todo-3-limit-player-positions-in-lineup">TODO 3: Limit Player Positions in Lineup</h2>
<div id="b7f38083" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># possible lineup positions</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>first_names <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Bryan Padilla'</span>, <span class="st">'Tyler Minick'</span>, <span class="st">'Drew Kron'</span>, <span class="st">'Beau Root'</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">'Caleb Shpur'</span>, <span class="st">'Sam Biller'</span>, <span class="st">'Rob Rispoli'</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>second_names <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Bryan Padilla'</span>, <span class="st">'Tyler Minick'</span>, <span class="st">'Drew Kron'</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'Beau Root'</span>, <span class="st">'Sam Biller'</span>, <span class="st">'Rob Rispoli'</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>third_names <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Maddix Dalena'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Jack LaRose'</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Bryan Padilla'</span>, <span class="st">'Tyler Minick'</span>, <span class="st">'Drew Kron'</span>, <span class="st">'Beau Root'</span>, <span class="st">'Sam Biller'</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'Rob Rispoli'</span>, <span class="st">'Ryan Daniels'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Gabriel Tirado'</span>]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>fourth_names <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Maddix Dalena'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Jack LaRose'</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Bryan Padilla'</span>, <span class="st">'Tyler Minick'</span>, <span class="st">'Drew Kron'</span>, <span class="st">'Beau Root'</span>, <span class="st">'Sam Biller'</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'Rob Rispoli'</span>, <span class="st">'Ryan Daniels'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Gabriel Tirado'</span>]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>fifth_names <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Maddix Dalena'</span>, <span class="st">'Beau Root'</span>, <span class="st">'Caleb Shpur'</span>, <span class="st">'Bryan Padilla'</span>, <span class="st">'Tyler Minick'</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Ryan Daniels'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Gabriel Tirado'</span>, <span class="st">'Sam Biller'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'Rob Rispoli'</span>, <span class="st">'Mike Oates'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Jack LaRose'</span>, <span class="st">'Drew Kron'</span>]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>sixth_names <span class="op">=</span> [<span class="st">'Matt Garbowski'</span>, <span class="st">'Maddix Dalena'</span>, <span class="st">'Beau Root'</span>, <span class="st">'Caleb Shpur'</span>, <span class="st">'Tyler Minick'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Ryan Daniels'</span>, <span class="st">'Anthony Belisario'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Gabriel Tirado'</span>, <span class="st">'Sam Biller'</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'Rob Rispoli'</span>, <span class="st">'Mike Oates'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Jack LaRose'</span>, <span class="st">'Drew Kron'</span>]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>seventh_names <span class="op">=</span> [<span class="st">'Caleb Shpur'</span>, <span class="st">'Ryan Daniels'</span>, <span class="st">'Anthony Belisario'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Gabriel Tirado'</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Sam Biller'</span>, <span class="st">'Carter Groen'</span>, <span class="st">'Rob Rispoli'</span>, <span class="st">'Mike Oates'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Jack LaRose'</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                                                                                                    <span class="st">'Drew Kron'</span>]</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>eighth_names <span class="op">=</span> [<span class="st">'Ryan Daniels'</span>, <span class="st">'Anthony Belisario'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Gabriel Tirado'</span>, </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Sam Biller'</span>, <span class="st">'Carter Groen'</span>, <span class="st">'Rob Rispoli'</span>, <span class="st">'Mike Oates'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Jack LaRose'</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                                                                                                    <span class="st">'Drew Kron'</span>]</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>ninth_names <span class="op">=</span> [<span class="st">'Ryan Daniels'</span>, <span class="st">'Anthony Belisario'</span>, <span class="st">'Connor Lane'</span>, <span class="st">'Gabriel Tirado'</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Carter Groen'</span>, <span class="st">'Mike Oates'</span>, <span class="st">'Grant MacArthur'</span>, <span class="st">'Jack LaRose'</span>, <span class="st">'Drew Kron'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="probabilities-simulation-preparation" class="level2">
<h2 class="anchored" data-anchor-id="probabilities-simulation-preparation">Probabilities &amp; Simulation Preparation</h2>
<div id="c5a56f3e" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability assumptions</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>prob_2ndtohome_single <span class="op">=</span> <span class="fl">0.60</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>prob_1sttohome_double <span class="op">=</span> <span class="fl">0.45</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>prob_2ndto3rd_double <span class="op">=</span> <span class="fl">0.10</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>num_games <span class="op">=</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="monte-carlo-simulation" class="level1">
<h1>Monte-Carlo Simulation</h1>
<div id="b23b8c64" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table for mapping player names to numbers</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lookup_table <span class="op">=</span> pd.DataFrame({<span class="st">'Number_for_Player'</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">20</span>), </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'Player_Name'</span>: req_data[<span class="st">'Name'</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6b24bbd7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>c_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(catcher))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>first_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(first_b))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>second_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(second_b))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>third_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(third_b))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>short_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(ss))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>left_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(left))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>center_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(center))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>right_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(right))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>dh_nums <span class="op">=</span> np.empty(<span class="bu">len</span>(dh))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_lookup(pos, pos_lst):</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(pos_lst)):</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            pos_lst[i] <span class="op">=</span> lookup_table[<span class="st">'Player_Name'</span>].tolist().index(pos[i]) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            pos_lst[i] <span class="op">=</span> np.nan</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>fill_lookup(catcher, c_nums)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>fill_lookup(first_b, first_nums)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>fill_lookup(second_b, second_nums)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>fill_lookup(third_b, third_nums)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>fill_lookup(ss, short_nums)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>fill_lookup(left, left_nums)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>fill_lookup(center, center_nums)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>fill_lookup(right, right_nums)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>fill_lookup(dh, dh_nums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d435d146" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>comb_grid <span class="op">=</span> pd.DataFrame(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    itertools.product(c_nums, first_nums, second_nums, third_nums, short_nums, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                                    left_nums, right_nums, center_nums, dh_nums),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'C_Numbers'</span>, <span class="st">'First_Numbers'</span>, <span class="st">'Second_Numbers'</span>, <span class="st">'Short_Numbers'</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">'Third_Numbers'</span>, <span class="st">'LF_Numbers'</span>, <span class="st">'RF_Numbers'</span>, <span class="st">'CF_Numbers'</span>, <span class="st">'DH_Numbers'</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>comb_grid <span class="op">=</span> comb_grid.values</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">'C_Numbers'</span>, <span class="st">'First_Numbers'</span>, <span class="st">'Second_Numbers'</span>, <span class="st">'Short_Numbers'</span>, <span class="st">'Third_Numbers'</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'LF_Numbers'</span>, <span class="st">'RF_Numbers'</span>, <span class="st">'CF_Numbers'</span>, <span class="st">'DH_Numbers'</span>]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>comb_grid <span class="op">=</span> pd.DataFrame(comb_grid, columns <span class="op">=</span> cols)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>comb_grid[<span class="st">'TestingColumn'</span>] <span class="op">=</span> <span class="st">'tmp'</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>comb_grid[<span class="st">'TestingColumn'</span>] <span class="op">=</span> comb_grid.iloc[:, :<span class="dv">9</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> row: <span class="bu">len</span>(<span class="bu">set</span>(row)), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>comb_grid <span class="op">=</span> comb_grid[comb_grid[<span class="st">'TestingColumn'</span>] <span class="op">==</span> <span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0cda0ce8" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>starters <span class="op">=</span> [lookup_table[<span class="st">'Player_Name'</span>].tolist().index(starter) <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> starter <span class="kw">in</span> starters]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>comb_grid[<span class="st">'start_test'</span>] <span class="op">=</span> comb_grid.iloc[:, :<span class="dv">9</span>].<span class="bu">apply</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> row: <span class="bu">all</span>(num <span class="kw">in</span> row.values <span class="cf">for</span> num <span class="kw">in</span> starters), axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>comb_grid <span class="op">=</span> comb_grid[comb_grid[<span class="st">'start_test'</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>comb_grid.drop(columns <span class="op">=</span> [<span class="st">'start_test'</span>, <span class="st">'TestingColumn'</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>comb_grid.columns <span class="op">=</span> [<span class="st">'C'</span>, <span class="st">'1B'</span>, <span class="st">'2B'</span>, <span class="st">'SS'</span>, <span class="st">'3B'</span>, <span class="st">'LF'</span>, <span class="st">'RF'</span>, <span class="st">'CF'</span>, <span class="st">'DH'</span>]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>comb_grid_text <span class="op">=</span> comb_grid.copy()</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> comb_grid_text.columns:</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    comb_grid_text[col] <span class="op">=</span> comb_grid_text[col].<span class="bu">apply</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> num: lookup_table.iloc[<span class="bu">int</span>(num) <span class="op">-</span> <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="17ce265c" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>first_permutations <span class="op">=</span> <span class="bu">list</span>(itertools.permutations(comb_grid.iloc[<span class="dv">0</span>, :].astype(<span class="bu">int</span>)))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>permutations_expanded <span class="op">=</span> pd.DataFrame(first_permutations)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, comb_grid.shape[<span class="dv">0</span>]):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    row_permutations <span class="op">=</span> <span class="bu">list</span>(itertools.permutations(comb_grid.iloc[i, :].astype(<span class="bu">int</span>)))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    permutations_expanded <span class="op">=</span> pd.concat(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        [permutations_expanded, pd.DataFrame(row_permutations)], ignore_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>permutations_expanded.columns <span class="op">=</span> [<span class="st">'first'</span>, <span class="st">'second'</span>, <span class="st">'third'</span>, <span class="st">'fourth'</span>, <span class="st">'fifth'</span>, <span class="st">'sixth'</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                                                            <span class="st">'seventh'</span>, <span class="st">'eighth'</span>, <span class="st">'ninth'</span>]</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>permutations_expanded <span class="op">=</span> permutations_expanded.drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="91c01777" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> map_to_indices(names, lookup_table):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lookup_table.loc[lookup_table[<span class="st">'Player_Name'</span>].isin(names), <span class="st">'Number_for_Player'</span>].tolist()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>first_opt <span class="op">=</span> map_to_indices(first_names, lookup_table)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>second_opt <span class="op">=</span> map_to_indices(second_names, lookup_table)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>third_opt <span class="op">=</span> map_to_indices(third_names, lookup_table)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>fourth_opt <span class="op">=</span> map_to_indices(fourth_names, lookup_table)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>fifth_opt <span class="op">=</span> map_to_indices(fifth_names, lookup_table)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>sixth_opt <span class="op">=</span> map_to_indices(sixth_names, lookup_table)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>seventh_opt <span class="op">=</span> map_to_indices(seventh_names, lookup_table)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>eighth_opt <span class="op">=</span> map_to_indices(eighth_names, lookup_table)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>ninth_opt <span class="op">=</span> map_to_indices(ninth_names, lookup_table)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>permutations_condensed <span class="op">=</span> permutations_expanded[</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'first'</span>].isin(first_opt)) <span class="op">&amp;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'second'</span>].isin(second_opt)) <span class="op">&amp;</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'third'</span>].isin(third_opt)) <span class="op">&amp;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'fourth'</span>].isin(fourth_opt)) <span class="op">&amp;</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'fifth'</span>].isin(fifth_opt)) <span class="op">&amp;</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'sixth'</span>].isin(sixth_opt)) <span class="op">&amp;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'seventh'</span>].isin(seventh_opt)) <span class="op">&amp;</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'eighth'</span>].isin(eighth_opt)) <span class="op">&amp;</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    (permutations_expanded[<span class="st">'ninth'</span>].isin(ninth_opt))</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>permutations_condensed[<span class="st">'mean_runs'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>permutations_condensed[<span class="st">'sd_runs'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>permutations_condensed <span class="op">=</span> permutations_condensed.reset_index()</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>permutations_condensed <span class="op">=</span> permutations_condensed.drop(columns <span class="op">=</span> [<span class="st">'index'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8ee0bfa1" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">2025</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_cols(prev_row, hit, prob_wts <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Move runners and update score.'''</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    r1 <span class="op">=</span> prev_row[<span class="dv">9</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> prev_row[<span class="dv">10</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    r3 <span class="op">=</span> prev_row[<span class="dv">11</span>]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    runs <span class="op">=</span> prev_row[<span class="dv">12</span>]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># single</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> hit <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># no runners</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, runs]</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, runs]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">0</span>: </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">1</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b &amp; 2b</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">2</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3b</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b &amp; 3b</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">1</span>: <span class="cf">return</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b &amp; 3b</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> r3 <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">1</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs]</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># bases loaded</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r3 <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">2</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">+</span> runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs]</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># double</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> hit <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># no runners</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, runs]</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b -- homebydouble</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">1</span>: </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">2</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b -- 2ndto3rd</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">2</span>, <span class="dv">3</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, runs]</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b &amp; 2b -- homebydouble</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">2</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs]</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3b </span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b &amp; 3b -- homebydouble</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">2</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs]</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b &amp; 3b -- 2ndto3rd</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> r1 <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">2</span>, <span class="dv">3</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># bases loaded -- homebydouble</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r3 <span class="op">==</span> <span class="dv">1</span>: </span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>            r1 <span class="op">=</span> random.choices([<span class="dv">3</span>, <span class="dv">2</span>], weights <span class="op">=</span> prob_wts, k <span class="op">=</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs] <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span> <span class="op">+</span> runs]</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># triple</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> hit <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># no runners</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, runs]</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b or 2b or 3b</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">!=</span> <span class="dv">0</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b &amp; 2b or 1b &amp; 3b or 2b &amp; 3b</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">!=</span> <span class="dv">0</span> <span class="kw">and</span> r2 <span class="op">!=</span> <span class="dv">0</span> <span class="kw">and</span> r3 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs]</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># bases loaded</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r3 <span class="op">==</span> <span class="dv">1</span>: <span class="cf">return</span> [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span> <span class="op">+</span> runs]</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># homerun</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> hit <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># no runners</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> r1 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span> <span class="op">+</span> runs]</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b, 2b, 3b</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">!=</span> <span class="dv">0</span> <span class="kw">and</span> r2 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">+</span> runs] </span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1b &amp; 2b, 1b &amp; 3b, 2b &amp; 3b</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r1 <span class="op">!=</span> <span class="dv">0</span> <span class="kw">and</span> r2 <span class="op">!=</span> <span class="dv">0</span> <span class="kw">and</span> r3 <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span> <span class="op">+</span> runs]</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>        <span class="co"># bases loaded</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> r3 <span class="op">==</span> <span class="dv">1</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span> <span class="op">+</span> runs]  </span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: <span class="cf">return</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_event(cur_row, prev_row):</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Update game settings and score based on event.'''</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>    prev_row <span class="op">=</span> np.nan_to_num(prev_row, nan <span class="op">=</span> <span class="dv">0</span>)    </span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>    <span class="co"># last out of game -- nothing left to update</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> prev_row[<span class="dv">7</span>] <span class="op">==</span> <span class="dv">9</span> <span class="kw">and</span> prev_row[<span class="dv">8</span>] <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>        cur_row[<span class="dv">7</span>] <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>        cur_row[<span class="dv">8</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>        cur_row[<span class="dv">12</span>] <span class="op">=</span> prev_row[<span class="dv">12</span>]</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># less than 3 outs</span></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> prev_row[<span class="dv">8</span>] <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>        cur_row[<span class="dv">7</span>:<span class="dv">9</span>] <span class="op">=</span> prev_row[<span class="dv">7</span>:<span class="dv">9</span>]</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>        cur_row[<span class="dv">12</span>] <span class="op">=</span> prev_row[<span class="dv">12</span>]</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no hit</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cur_row[<span class="dv">6</span>] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prev_row[<span class="dv">8</span>] <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>            cur_row[<span class="dv">8</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> prev_row[<span class="dv">8</span>]</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>            cur_row[<span class="dv">9</span>:] <span class="op">=</span> prev_row[<span class="dv">9</span>:]</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>            cur_row[<span class="dv">8</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>            cur_row[<span class="dv">12</span>] <span class="op">=</span> prev_row[<span class="dv">12</span>]</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># single</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> cur_row[<span class="dv">6</span>] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>        settings <span class="op">=</span> update_cols(prev_row, <span class="dv">1</span>, [<span class="dv">1</span> <span class="op">-</span> prob_2ndtohome_single, prob_2ndtohome_single])</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>    <span class="co"># double </span></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> cur_row[<span class="dv">6</span>] <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prev_row[<span class="dv">9</span>] <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> prev_row[<span class="dv">9</span>] <span class="op">==</span> <span class="dv">1</span> <span class="kw">or</span> prev_row[<span class="dv">11</span>] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>            probs <span class="op">=</span> [<span class="dv">1</span> <span class="op">-</span> prob_1sttohome_double, prob_1sttohome_double]</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>            probs <span class="op">=</span> [<span class="dv">1</span> <span class="op">-</span> prob_2ndto3rd_double, prob_2ndto3rd_double]</span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>        settings <span class="op">=</span> update_cols(prev_row, <span class="dv">2</span>, probs)</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># triple</span></span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> cur_row[<span class="dv">6</span>] <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>        settings <span class="op">=</span> update_cols(prev_row, <span class="dv">3</span>)</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># homerun</span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> cur_row[<span class="dv">6</span>] <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>        settings <span class="op">=</span> update_cols(prev_row, <span class="dv">4</span>)</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cur_row[<span class="dv">6</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>        cur_row[<span class="dv">9</span>], cur_row[<span class="dv">10</span>], cur_row[<span class="dv">11</span>], cur_row[<span class="dv">12</span>] <span class="op">=</span> settings</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>    cur_row <span class="op">=</span> np.nan_to_num(cur_row, nan <span class="op">=</span> <span class="dv">0</span>) </span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cur_row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9f5013bd" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">2025</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map batter names to integers</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>batter_names <span class="op">=</span> req_data.iloc[:, <span class="dv">0</span>].unique()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>batter_map <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(lookup_table[<span class="st">'Player_Name'</span>], lookup_table[<span class="st">'Number_for_Player'</span>]))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>num_permutations <span class="op">=</span> <span class="bu">len</span>(permutations_condensed)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize storage for run counts and game data</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>run_total <span class="op">=</span> np.zeros(num_games)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>skeleton_arr <span class="op">=</span> np.full((<span class="dv">81</span>, <span class="dv">13</span>), np.nan, dtype <span class="op">=</span> <span class="bu">float</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate through lineups</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_permutations):</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get possible lineup </span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> permutations_condensed.iloc[i, :<span class="dv">9</span>].values <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get list of batters and encode names as integers</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    batter_vec <span class="op">=</span> req_data.iloc[indices, <span class="dv">0</span>].values</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    batter_vec <span class="op">=</span> np.vectorize(<span class="kw">lambda</span> name: batter_map[name])(batter_vec)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get probabilities associated with lineup</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    prob_vecs <span class="op">=</span> req_data.iloc[indices, <span class="dv">1</span>:<span class="dv">6</span>].values</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># combine batter and probability vectors into array of length 81</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    skeleton_arr[:, :<span class="dv">6</span>] <span class="op">=</span> np.tile(np.column_stack([batter_vec, prob_vecs]), (<span class="dv">9</span>, <span class="dv">1</span>))</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># normalize data so probabilities add to one</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    prob_cols <span class="op">=</span> skeleton_arr[:, <span class="dv">1</span>:<span class="dv">6</span>]</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    prob_sums <span class="op">=</span> prob_cols.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>, keepdims <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    skeleton_arr[:, <span class="dv">1</span>:<span class="dv">6</span>] <span class="op">=</span> prob_cols <span class="op">/</span> prob_sums</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># iterate through games</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_games):</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp <span class="op">=</span> skeleton_arr.copy()</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># assign a random result (out, single, double, triple, homerun) to each row</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[:, <span class="dv">6</span>] <span class="op">=</span> np.array([</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>            np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], size <span class="op">=</span> <span class="dv">1</span>, p <span class="op">=</span> row)[<span class="dv">0</span>]</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> row <span class="kw">in</span> skeleton_arr_tmp[:, <span class="dv">1</span>:<span class="dv">6</span>]</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># initial states</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[:, <span class="dv">7</span>] <span class="op">=</span> <span class="dv">1</span>  <span class="co"># inning</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[:, <span class="dv">12</span>] <span class="op">=</span> <span class="dv">0</span>  <span class="co"># runs</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[:, <span class="dv">8</span>] <span class="op">=</span> <span class="dv">0</span>  <span class="co"># outs</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># first outcome of game</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>        first_res <span class="op">=</span> skeleton_arr_tmp[<span class="dv">0</span>, <span class="dv">6</span>]</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust outs and runs according to first outcome</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[<span class="dv">0</span>, <span class="dv">8</span>] <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> first_res <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[<span class="dv">0</span>, <span class="dv">12</span>] <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> first_res <span class="op">==</span> <span class="dv">4</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># update runner placements according to first outcome</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[<span class="dv">0</span>, <span class="dv">9</span>:<span class="dv">12</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[<span class="dv">0</span>, <span class="dv">9</span>] <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> first_res <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[<span class="dv">0</span>, <span class="dv">10</span>] <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> first_res <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>        skeleton_arr_tmp[<span class="dv">0</span>, <span class="dv">11</span>] <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> first_res <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># iterate through each at bat</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(skeleton_arr_tmp)): </span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># store previous and current rows</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>            prev_row <span class="op">=</span> skeleton_arr_tmp[k <span class="op">-</span> <span class="dv">1</span>, :]</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>            cur_row <span class="op">=</span> skeleton_arr_tmp[k, :]</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># end of game -- stop</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (prev_row[<span class="dv">7</span>] <span class="op">==</span> <span class="dv">9</span> <span class="kw">and</span> prev_row[<span class="dv">8</span>] <span class="op">==</span> <span class="dv">3</span>):</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>                skeleton_arr_tmp[k, <span class="dv">7</span>] <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>                skeleton_arr_tmp[k, <span class="dv">8</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>                skeleton_arr_tmp[k, <span class="dv">12</span>] <span class="op">=</span> prev_row[<span class="dv">12</span>]</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>            <span class="co"># process next outcome of game</span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>                skeleton_arr_tmp[k, :] <span class="op">=</span> process_event(cur_row, prev_row)</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get run total for each game and lineup</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>        run_total[j] <span class="op">=</span> skeleton_arr_tmp[<span class="dv">80</span>, <span class="dv">12</span>]</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate mean and standard deviation of all run totals</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>    orderopt_mean <span class="op">=</span> np.mean(run_total)</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>    orderopt_sd <span class="op">=</span> np.std(run_total)</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>    permutations_condensed.loc[i, <span class="st">'mean_runs'</span>] <span class="op">=</span> orderopt_mean</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>    permutations_condensed.loc[i, <span class="st">'sd_runs'</span>] <span class="op">=</span> orderopt_sd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/4118883425.py:84: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '55.15' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  permutations_condensed.loc[i, 'mean_runs'] = orderopt_mean
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/4118883425.py:85: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '4.682680856090878' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  permutations_condensed.loc[i, 'sd_runs'] = orderopt_sd</code></pre>
</div>
</div>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<div id="a51f68ee" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>text_results <span class="op">=</span> permutations_condensed </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert integers back to names</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text_results)):</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        numeric_value <span class="op">=</span> <span class="bu">int</span>(text_results.iloc[j, i]) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        text_results.iloc[j, i] <span class="op">=</span> lookup_table.iloc[numeric_value, <span class="dv">1</span>]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sort lineups by most runs created</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>text_results <span class="op">=</span> text_results.sort_values(by <span class="op">=</span> <span class="st">'mean_runs'</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get top three best lineups</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>top_3 <span class="op">=</span> text_results.iloc[:<span class="dv">3</span>, :<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>top_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Matt Garbowski' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Bryan Padilla' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Maddix Dalena' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Ryan Daniels' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Rob Rispoli' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Tyler Minick' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Caleb Shpur' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Sam Biller' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]
/var/folders/h2/7lwllvws0vzfqyxt5_n92yhc0000gn/T/ipykernel_70025/3935060079.py:7: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'Carter Groen' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  text_results.iloc[j, i] = lookup_table.iloc[numeric_value, 1]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">first</th>
<th data-quarto-table-cell-role="th">second</th>
<th data-quarto-table-cell-role="th">third</th>
<th data-quarto-table-cell-role="th">fourth</th>
<th data-quarto-table-cell-role="th">fifth</th>
<th data-quarto-table-cell-role="th">sixth</th>
<th data-quarto-table-cell-role="th">seventh</th>
<th data-quarto-table-cell-role="th">eighth</th>
<th data-quarto-table-cell-role="th">ninth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1694</td>
<td>Sam Biller</td>
<td>Bryan Padilla</td>
<td>Matt Garbowski</td>
<td>Maddix Dalena</td>
<td>Tyler Minick</td>
<td>Rob Rispoli</td>
<td>Caleb Shpur</td>
<td>Ryan Daniels</td>
<td>Carter Groen</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">530</td>
<td>Matt Garbowski</td>
<td>Tyler Minick</td>
<td>Rob Rispoli</td>
<td>Maddix Dalena</td>
<td>Bryan Padilla</td>
<td>Sam Biller</td>
<td>Caleb Shpur</td>
<td>Carter Groen</td>
<td>Ryan Daniels</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1022</td>
<td>Bryan Padilla</td>
<td>Sam Biller</td>
<td>Tyler Minick</td>
<td>Maddix Dalena</td>
<td>Caleb Shpur</td>
<td>Matt Garbowski</td>
<td>Ryan Daniels</td>
<td>Rob Rispoli</td>
<td>Carter Groen</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="additional-notes" class="level1">
<h1>Additional Notes</h1>
<ol type="1">
<li>The current runtime is about 20-25 minutes for the number of players currently used and the number of preset starters. This could change depending on how many starters you manually set (currently has <span class="math inline">\(8\)</span>), but overall this shouldnt exceed an hour.</li>
<li>The most optimal lineups may not include players in the exact positions you want. To set more strict restrictions, you can edit the nine list in the first TODO section. These state the players that can be chosen for each position and are currently pretty generous in terms of providing multiple players for each position. Obviously, you may have a single player in mind for a certain position, so you can limit those lists if needed.</li>
<li>If players are added or removed from the roster, they need to also be added/removed from multiple places in the TODO sections. In TODO 1, they need to be removed from all positions lists theyre included in or added to any lists for positions they may play. For TODO 2, removed players must be removed and added players should be added if they have a definite starting position. Lastly, for TODO 3, removed players must be removed fromm all lists theyre included in and new players must be added to at least one list.</li>
<li>A quick explanation of the third TODO, as its not as intuitive as the other two: the third TODO is there to limit permutations and remove lineups that are most definitely not optimal. The lists first through ninth include all players that can be placed in that lineup position. For example, Bryan Padilla is a senior and clearly one of UConns better hitters, so Ive removed him from the bottom half of the lineup, as even without proper testing, its clear that wouldnt be an appropriate position for him. If youd really like to see all lineup combinations, you can put the entire roster in each of the nine lists. I discourage this though, as it will make the running time of the code exponentially larger. Feel free to play around with smaller changes if youd like.</li>
<li>You may run into issues with importing the data since I have it saved with a specific name and in a specific folder. In the last line of the first code block, the data is currently imported as data/in-game-trackman/final_fall_stats.csv. For me, this is inside a data folder containing another folder title in-game-trackman, and the file itself is final_fall_stats.csv. You can rename anything youd like, and remove everything but final_fall_stats.csv if you dont have the data stored in a folder.</li>
</ol>
<p>:::</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>